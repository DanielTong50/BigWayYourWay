{"version":3,"file":"_server-2xZ-NSJr.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/waitlist/_server.js"],"sourcesContent":["import { j as json } from \"../../../../chunks/index.js\";\nimport { a as addToWaitlist, g as getQueuePosition, b as getCurrentPartiesCount } from \"../../../../chunks/db.js\";\nasync function POST({ request }) {\n  try {\n    const data = await request.json();\n    const { name, phone, partySize } = data;\n    if (!name || !phone || !partySize) {\n      return json({ error: \"Missing required fields\" }, { status: 400 });\n    }\n    const phoneDigits = phone.replace(/\\D/g, \"\");\n    if (phoneDigits.length !== 10) {\n      return json({ error: \"Invalid phone number format\" }, { status: 400 });\n    }\n    const result = await addToWaitlist(name, phoneDigits, parseInt(partySize));\n    if (!result || !result.id) {\n      throw new Error(\"Failed to add to waitlist\");\n    }\n    const position = await getQueuePosition(result.id);\n    if (!position) {\n      throw new Error(\"Failed to get queue position\");\n    }\n    return json({\n      success: true,\n      id: result.id,\n      position: position.position + 1\n    });\n  } catch (error) {\n    console.error(\"Error adding to waitlist:\", error);\n    return json({\n      error: \"Failed to add to waitlist. Please try again.\"\n    }, { status: 500 });\n  }\n}\nasync function GET() {\n  try {\n    const count = await getCurrentPartiesCount();\n    return json({ count });\n  } catch (error) {\n    console.error(\"Error getting waitlist count:\", error);\n    return json({\n      error: \"Failed to get waitlist count\",\n      count: 0\n    }, { status: 500 });\n  }\n}\nexport {\n  GET,\n  POST\n};\n"],"names":[],"mappings":";;;;AAEA,eAAe,IAAI,CAAC,EAAE,OAAO,EAAE,EAAE;AACjC,EAAE,IAAI;AACN,IAAI,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE;AACrC,IAAI,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,IAAI;AAC3C,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,SAAS,EAAE;AACvC,MAAM,OAAO,IAAI,CAAC,EAAE,KAAK,EAAE,yBAAyB,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AACxE;AACA,IAAI,MAAM,WAAW,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;AAChD,IAAI,IAAI,WAAW,CAAC,MAAM,KAAK,EAAE,EAAE;AACnC,MAAM,OAAO,IAAI,CAAC,EAAE,KAAK,EAAE,6BAA6B,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AAC5E;AACA,IAAI,MAAM,MAAM,GAAG,MAAM,aAAa,CAAC,IAAI,EAAE,WAAW,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAC;AAC9E,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE;AAC/B,MAAM,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC;AAClD;AACA,IAAI,MAAM,QAAQ,GAAG,MAAM,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC;AACtD,IAAI,IAAI,CAAC,QAAQ,EAAE;AACnB,MAAM,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC;AACrD;AACA,IAAI,OAAO,IAAI,CAAC;AAChB,MAAM,OAAO,EAAE,IAAI;AACnB,MAAM,EAAE,EAAE,MAAM,CAAC,EAAE;AACnB,MAAM,QAAQ,EAAE,QAAQ,CAAC,QAAQ,GAAG;AACpC,KAAK,CAAC;AACN,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK,CAAC,2BAA2B,EAAE,KAAK,CAAC;AACrD,IAAI,OAAO,IAAI,CAAC;AAChB,MAAM,KAAK,EAAE;AACb,KAAK,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AACvB;AACA;AACA,eAAe,GAAG,GAAG;AACrB,EAAE,IAAI;AACN,IAAI,MAAM,KAAK,GAAG,MAAM,sBAAsB,EAAE;AAChD,IAAI,OAAO,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC;AAC1B,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK,CAAC,+BAA+B,EAAE,KAAK,CAAC;AACzD,IAAI,OAAO,IAAI,CAAC;AAChB,MAAM,KAAK,EAAE,8BAA8B;AAC3C,MAAM,KAAK,EAAE;AACb,KAAK,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AACvB;AACA;;;;"}